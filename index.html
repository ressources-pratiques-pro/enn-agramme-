<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ennéagramme</title>
  <link rel="stylesheet" href="assets/css/app.css?v=101" />
</head>

<body>
  <div class="wrap">
    <header class="top">
      <div>
        <h1 class="brandTitle">Ennéagramme</h1>
        <p>Clique sur un type pour voir un résumé, puis ouvrir la fiche complète.</p>
      </div>
      <div class="actions">
        <button id="btnReset" type="button">Réinitialiser</button>
      </div>
    </header>

    <main class="grid">
      <section class="stage" id="stage">
        <div class="svgWrap">
          <svg id="enneaSvg" viewBox="0 0 700 700" aria-label="Diagramme de l'ennéagramme">
            <defs>
              <marker id="arrowHeadGreen" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto" markerUnits="strokeWidth">
                <path d="M 0 0 L 10 5 L 0 10 z" fill="rgba(134,239,172,.95)"></path>
              </marker>
              <marker id="arrowHeadPink" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto" markerUnits="strokeWidth">
                <path d="M 0 0 L 10 5 L 0 10 z" fill="rgba(253,164,175,.95)"></path>
              </marker>

              <filter id="softGlow" x="-30%" y="-30%" width="160%" height="160%">
                <feGaussianBlur stdDeviation="2.2" result="blur" />
                <feMerge>
                  <feMergeNode in="blur" />
                  <feMergeNode in="SourceGraphic" />
                </feMerge>
              </filter>
            </defs>

            <circle class="ring" cx="350" cy="350" r="270"></circle>
            <circle class="innerRing" cx="350" cy="350" r="210"></circle>

            <text x="350" y="352" text-anchor="middle" dominant-baseline="middle"
                  class="svgCenterTitle">
              Ennéagramme
            </text>

            <g id="staticBg" class="staticBg">
              <path class="hex" d="" id="hexPath"></path>
              <path class="tri" d="" id="triPath"></path>

              <g class="centers">
                <path class="centerLine" d="M350 350 L350 120"></path>
                <path class="centerLine" d="M350 350 L585 455"></path>
                <path class="centerLine" d="M350 350 L115 455"></path>

                <text class="centerLabel instinctif" x="350" y="255" text-anchor="middle">Instinctif</text>
                <text class="centerLabel emotionnel" x="468" y="415" text-anchor="middle">Émotionnel</text>
                <text class="centerLabel mental" x="232" y="415" text-anchor="middle">Mental</text>
              </g>
            </g>

            <g id="arrowsLayer"></g>
            <g id="nodesLayer"></g>
          </svg>
        </div>
      </section>

      <aside class="side" aria-live="polite">
        <div class="badgeRow">
          <div class="badge"><strong>Type</strong> <span id="badgeNum">—</span></div>
        </div>

        <div class="card">
          <div class="miniGrid">
            <div class="mini"><h3>Centre d'intelligence</h3><p id="center">-</p></div>
            <div class="mini"><h3>Peur de base</h3><p id="fear">-</p></div>
            <div class="mini"><h3>Désir de base</h3><p id="desire">-</p></div>
            <div class="mini"><h3>Compulsion (évitement)</h3><p id="compulsion">-</p></div>
          </div>

          <div class="moveLines">
            <div id="moveHealth" class="moveLine">
              <div class="moveHead">
                <span class="dot good"></span>
                <strong>Intégration</strong>
                <span class="muted">(santé)</span>
                <span class="muted"> > </span>
                <strong id="toIntegr">-</strong>
                <span class="muted">:</span>
              </div>
              <div class="moveBody" id="moveHealthText">-</div>
            </div>

            <div id="moveStress" class="moveLine">
              <div class="moveHead">
                <span class="dot warn"></span>
                <strong>Désintégration</strong>
                <span class="muted">(stress)</span>
                <span class="muted"> > </span>
                <strong id="toDisint">-</strong>
                <span class="muted">:</span>
              </div>
              <div class="moveBody" id="moveStressText">-</div>
            </div>
          </div>

          <div class="ctaRow">
            <a id="openFull" class="btn" href="profils/type1.html" aria-disabled="true">Voir la fiche complète</a>
            <a id="openProfil" class="btn" href="test-enneagramme-sans-indice.html">Passer le test</a>
            <a class="btn" href="explore.html">Explorer l'Ennéagramme</a>
          </div>

          <div class="chooser">
            <div class="chooserTitle">Choisir un profil</div>
            <div class="chooserRow">
              <select id="profilePick" class="chooserSelect" aria-label="Choisir un profil">
                <option value="">Sélectionne un type…</option>
                <option value="1">Type 1</option>
                <option value="2">Type 2</option>
                <option value="3">Type 3</option>
                <option value="4">Type 4</option>
                <option value="5">Type 5</option>
                <option value="6">Type 6</option>
                <option value="7">Type 7</option>
                <option value="8">Type 8</option>
                <option value="9">Type 9</option>
              </select>

              <button id="goProfile" type="button" class="chooserBtn" disabled>Ouvrir</button>
            </div>
            <div class="chooserHint">Astuce : la sélection te remonte au diagramme et met en évidence le type.</div>
          </div>
        </div>
      </aside>
    </main>

    <footer class="siteFooter">
      <div class="footerInner">
        <span class="copy">Brahms – Tous droits réservés</span>
        <a class="contact" href="https://docs.google.com/forms/d/e/1FAIpQLScLBwWZA-VZf4OaIEl11fnKasayyVrll7DZL5A3uZZBCwLdkQ/viewform?usp=header" target="_blank" rel="noopener">
          ✉️ Écrire à Brahms
        </a>
      </div>
    </footer>
  </div>

  <script src="assets/js/app.js?v=100"></script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const pick = document.getElementById("profilePick");
      const go = document.getElementById("goProfile");
      const stage = document.getElementById("stage");
      const nodesLayer = document.getElementById("nodesLayer");

      function clearHints(){
        if(!nodesLayer) return;
        nodesLayer.querySelectorAll(".node").forEach(n => n.classList.remove("hint"));
      }

      function hintType(t){
        if(!nodesLayer) return;
        clearHints();
        const node = nodesLayer.querySelector(`.node[data-type="${t}"]`);
        if(node) node.classList.add("hint");
        setTimeout(clearHints, 2200);
      }

      function scrollToStage(){
        if(!stage) return;
        stage.scrollIntoView({ behavior: "smooth", block: "start" });
      }

      pick.addEventListener("change", () => {
        const t = parseInt(pick.value, 10);
        const ok = Number.isFinite(t) && t >= 1 && t <= 9;
        go.disabled = !ok;

        if(!ok) return;

        scrollToStage();
        if(typeof window.selectType === "function") window.selectType(t);
        hintType(t);
      });

      go.addEventListener("click", () => {
        const t = parseInt(pick.value, 10);
        if(!(Number.isFinite(t) && t >= 1 && t <= 9)) return;
        window.location.href = `profils/type${t}.html`;
      });
    });
  </script>
</body>
</html>